---
- action: update
  type: user
  id: 0
  template:
    ssh_public_key: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCYz+lkZoNyspRhrtXDKFN3cIEwN3w08mz0YGKpVDIiV0+/vgG8dAUQ70Irs3m83W9BHN+vNjKPgKcF+X+sSfxniOtavahxGCRjAhhs1IVm196C5ODbSgXVUWULdtmMHelXbLBJ8X340h/UO+eQ6eRLaRfslXUsgRqremVcvCCPz4LIuRiliGWiELAmqYcY+1zJLeg3QV2Pgn5vschM9e/A4AseKO+HnbGB/I5tnoeZT/Gc3FGfUZLNFVB2XsVGAEEzkqO8VI2msB7MCAZBHffIK6WfLIYgGP6Ha2JT1NWJU7Ncj9Xuql0ElF01VwWMDWzqc0DOiVSsTL89ugJKU6+h one"

- action: update
  type: datastore
  id: 0
  template:
      tm_mad: qcow2

- action: update
  type: datastore
  id: 1
  template:
      tm_mad: qcow2
      safe_dirs: "/var/tmp /tmp"

- action: create
  type: host
  name: localhost
  im: kvm
  vmm: kvm
  vnm: dummy

- action: create
  type: net
  template:
    name: public
    vn_mad: dummy
    bridge: br0
    gateway: 192.168.150.1
    gateway6: '2001:db8::1'
    dns: 172.20.0.1
    ar:
      - ip: 192.168.150.100
        global_prefix: '2001:db8::'
        ula_prefix: 'fd00::'
        size: 20
        type: IP4_6

- action: create
  type: net
  template:
    name: private
    vn_mad: dummy
    bridge: br0
    ar:
      - ip: 192.168.150.120
        global_prefix: '2001:db8::'
        ula_prefix: 'fd00::'
        size: 20
        type: IP4_6

- action: create
  type: net
  template:
    name: dhcp
    vn_mad: dummy
    bridge: br1
    ar:
      - mac: 02:00:c0:a8:6e:64
        size: 20
        type: ETHER

- action: create
  type: net
  template:
    name: vnet_a
    vn_mad: "802.1Q"
    phydev: tap0
    model: virtio
    gateway: 192.168.101.1
    dns: 192.168.101.1
    network_mask: 255.255.255.0
    automatic_vlan_id: "YES"
    ar:
      - ip: 192.168.101.1
        size: 1
        type: IP4
      - ip: 192.168.101.100
        size: 20
        type: IP4

- action: create
  type: net
  template:
    name: vnet_b
    vn_mad: "802.1Q"
    phydev: tap0
    model: virtio
    gateway: 192.168.102.1
    dns: 192.168.102.1
    network_mask: 255.255.255.0
    automatic_vlan_id: "YES"
    ar:
      - ip: 192.168.102.1
        size: 1
        type: IP4
      - ip: 192.168.102.100
        size: 20
        type: IP4

- action: create
  type: net
  template:
    name: vnet_mgt
    vn_mad: "802.1Q"
    phydev: tap0
    model: virtio
    gateway: 192.168.103.1
    dns: 192.168.103.1
    network_mask: 255.255.255.0
    automatic_vlan_id: "YES"
    ar:
      - ip: 192.168.103.1
        size: 1
        type: IP4
      - ip: 192.168.103.100
        size: 20
        type: IP4

- action: create
  type: net
  template:
    name: vnet_dmz
    vn_mad: "802.1Q"
    phydev: tap0
    model: virtio
    gateway: 192.168.104.1
    dns: 192.168.104.1
    network_mask: 255.255.255.0
    automatic_vlan_id: "YES"
    ar:
      - ip: 192.168.104.1
        size: 1
        type: IP4
      - ip: 192.168.104.100
        size: 20
        type: IP4

- action: create
  type: template
  template:
    name: base
    cpu: 0.1
    cpu_model:
      model: host-passthrough
    memory: 1024
    arch: x86_64
    nic_default:
      model: virtio
    nic:
      network: public
    graphics:
      type: vnc
      listen: 0.0.0.0
    context:
      ssh_public_key: $USER[SSH_PUBLIC_KEY]
      network: "YES"
